!function(e,t,a){function o(e,t,a){e.addEventListener?e.addEventListener(t,a,!1):e.attachEvent("on"+t,a)}function i(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return u[e.which]?u[e.which]:h[e.which]?h[e.which]:String.fromCharCode(e.which).toLowerCase()}function r(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function n(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function s(e,t){var a,o,i,r=[];for(a=e,"+"===a?a=["+"]:(a=a.replace(/\+{2}/g,"+plus"),a=a.split("+")),i=0;i<a.length;++i)o=a[i],m[o]&&(o=m[o]),t&&"keypress"!=t&&p[o]&&(o=p[o],r.push("shift")),n(o)&&r.push(o);if(a=o,i=t,!i){if(!d){d={};for(var s in u)s>95&&112>s||u.hasOwnProperty(s)&&(d[u[s]]=s)}i=d[a]?"keydown":"keypress"}return"keypress"==i&&r.length&&(i="keydown"),{key:o,modifiers:r,action:i}}function l(e,a){return null===e||e===t?!1:e===a?!0:l(e.parentNode,a)}function c(e){function a(e){e=e||{};var t,a=!1;for(t in v)e[t]?a=!0:v[t]=0;a||(b=!1)}function l(e,t,a,o,i,r){var s,l,c=[],d=a.type;if(!m._callbacks[e])return[];for("keyup"==d&&n(e)&&(t=[e]),s=0;s<m._callbacks[e].length;++s)if(l=m._callbacks[e][s],(o||!l.seq||v[l.seq]==l.level)&&d==l.action){var u;(u="keypress"==d&&!a.metaKey&&!a.ctrlKey)||(u=l.modifiers,u=t.sort().join(",")===u.sort().join(",")),u&&(u=o&&l.seq==o&&l.level==r,(!o&&l.combo==i||u)&&m._callbacks[e].splice(s,1),c.push(l))}return c}function d(e,t,a,o){m.stopCallback(t,t.target||t.srcElement,a,o)||!1!==e(t,a)||(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation?t.stopPropagation():t.cancelBubble=!0)}function u(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=i(e);t&&("keyup"==e.type&&f===t?f=!1:m.handleKey(t,r(e),e))}function h(e,t,o,r){function n(t){return function(){b=t,++v[e],clearTimeout(g),g=setTimeout(a,1e3)}}function l(t){d(o,t,e),"keyup"!==r&&(f=i(t)),setTimeout(a,10)}for(var c=v[e]=0;c<t.length;++c){var u=c+1===t.length?l:n(r||s(t[c+1]).action);p(t[c],u,r,e,c)}}function p(e,t,a,o,i){m._directMap[e+":"+a]=t,e=e.replace(/\s+/g," ");var r=e.split(" ");1<r.length?h(e,r,t,a):(a=s(e,a),m._callbacks[a.key]=m._callbacks[a.key]||[],l(a.key,a.modifiers,{type:a.action},o,e,i),m._callbacks[a.key][o?"unshift":"push"]({callback:t,modifiers:a.modifiers,action:a.action,seq:o,level:i,combo:e}))}var m=this;if(e=e||t,!(m instanceof c))return new c(e);m.target=e,m._callbacks={},m._directMap={};var g,v={},f=!1,_=!1,b=!1;m._handleKey=function(e,t,o){var i,r=l(e,t,o);t={};var s=0,c=!1;for(i=0;i<r.length;++i)r[i].seq&&(s=Math.max(s,r[i].level));for(i=0;i<r.length;++i)r[i].seq?r[i].level==s&&(c=!0,t[r[i].seq]=1,d(r[i].callback,o,r[i].combo,r[i].seq)):c||d(r[i].callback,o,r[i].combo);r="keypress"==o.type&&_,o.type!=b||n(e)||r||a(t),_=c&&"keydown"==o.type},m._bindMultiple=function(e,t,a){for(var o=0;o<e.length;++o)p(e[o],t,a)},o(e,"keypress",u),o(e,"keydown",u),o(e,"keyup",u)}var d,u={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},h={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},p={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},m={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"};for(a=1;20>a;++a)u[111+a]="f"+a;for(a=0;9>=a;++a)u[a+96]=a;c.prototype.bind=function(e,t,a){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,a),this},c.prototype.unbind=function(e,t){return this.bind.call(this,e,function(){},t)},c.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},c.prototype.reset=function(){return this._callbacks={},this._directMap={},this},c.prototype.stopCallback=function(e,t){return-1<(" "+t.className+" ").indexOf(" mousetrap ")||l(t,this.target)?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},c.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},c.init=function(){var e,a=c(t);for(e in a)"_"!==e.charAt(0)&&(c[e]=function(e){return function(){return a[e].apply(a,arguments)}}(e))},c.init(),e.Mousetrap=c,"undefined"!=typeof module&&module.exports&&(module.exports=c),"function"==typeof define&&define.amd&&define(function(){return c})}(window,document),function(e){var t=e.prototype.stopCallback;e.prototype.stopCallback=function(e,a,o){return this.paused?!0:t.call(this,e,a,o)},e.prototype.pause=function(){this.paused=!0},e.prototype.unpause=function(){this.paused=!1},e.init()}(Mousetrap);var api={url_response:function(e){"function"==typeof utils.url_response[e[0]]&&(utils.url_response[e[0]](e[1]),delete utils.url_response[e[0]])},focus:function(){window.focus()},progress:function(e){if(e){if(e[1]<1)var t=locale.translate("startingDownload");else var t=locale.translate("downloading");ui.loading_wrapper.change_stats(Math.round(e[0]),0,0,0,t)}}},locale={default_language:"en",langs:{en:"English",nl:"Dutch",pt:"Português",es:"Español",fr:"Français",it:"Italiano",de:"Deutsch",ru:"Pусский",kr:"한국말",ar:"العربية",ro:"Român",he:"עברית",pl:"Polski",tr:"Türkçe",sv:"Svenska"},construct:function(e){localStorage.getItem("localeCb3")||(localStorage.setItem("localeCb3","1"),localStorage.removeItem("locale_words")),locale.language=localStorage.getItem("locale")||locale.default_language;var t=localStorage.getItem("locale_words");if(t)try{t=JSON.parse(t)}catch(a){t=!1,console.log(a.message)}t?(locale.words=t,e()):$.get("/locale/"+locale.language+".json?id=5",function(t){try{locale.words="object"==typeof t?t:JSON.parse(t),localStorage.setItem("locale_words",JSON.stringify(locale.words)),localStorage.setItem("locale",locale.language),e()}catch(a){localStorage.getItem("locale_words")?(logger.log("error_parsing_locale_"+locale.language),localStorage.removeItem("locale_words"),locale.construct()):(console.log(a.message),logger.log("error_parsing_locale_en"))}},"json").fail(function(){localStorage.getItem("locale_words")?(logger.log("error_parsing_locale_"+locale.language),localStorage.removeItem("locale_words"),locale.construct()):logger.log("error_parsing_locale_en")})},translate_interface:function(){var e=locale.words||{};$("[data-title-trans]").each(function(){var t=$(this).attr("data-title-trans");$(this).attr("title",e[t]||t)}),$("[data-ph-trans]").each(function(){var t=$(this).attr("data-ph-trans");$(this).attr("placeholder",e[t]||t)}),$("[data-in-trans]").each(function(){var t=$(this).attr("data-in-trans");$(this).html(e[t]||t)})},translate:function(e){var t=locale.words||{};return t[e]||e.toString().capitalize()},lang2iso:{abkhazian:"ab",afar:"aa",afrikaans:"af",albanian:"sq",amharic:"am",arabic:"ar",armenian:"hy",assamese:"as",aymara:"ay",azerbaijani:"az",bashkir:"ba",basque:"eu",bengal:"bn",bhutani:"dz",bihari:"bh",bislama:"bi",bosnian:"bs",breton:"br",bulgarian:"bg",burmese:"my",byelorussian:"be",cambodian:"km",catalan:"ca",chinese:"zh",corsican:"co",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",esperanto:"eo",estonian:"et",faeroese:"fo",fiji:"fj",finnish:"fi",french:"fr",frisian:"fy",gaelic:"gd",galician:"gl",georgian:"ka",german:"de",greek:"el",greenlandic:"kl",guarani:"gn",gujarati:"gu",hausa:"ha",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"in",interlingua:"ia",interlingue:"ie",inupiak:"ik",irish:"ga",italian:"it",japanese:"ja",javanese:"jw",kannada:"kn",kashmiri:"ks",kazakh:"kk",kinyarwanda:"rw",kirghiz:"ky",kirundi:"rn",korean:"ko",kurdish:"ku",laothian:"lo",latin:"la",latvia:"lv",lingala:"ln",lithuanian:"lt",macedonian:"mk",malagasy:"mg",malay:"ms",malayalam:"ml",maltese:"mt",maori:"mi",marathi:"mr",moldavian:"mo",mongolian:"mn",nauru:"na",nepali:"ne",norwegian:"no",occitan:"oc",oriya:"or",orom:"om",pasht:"ps",persian:"fa",polish:"pl",portuguese:"pt",punjabi:"pa",quechua:"qu","rhaeto-romance":"rm",romanian:"ro",russian:"ru",samoan:"sm",sangro:"sg",sanskrit:"sa",serbian:"sr","serbo-croatian":"sh",sesotho:"st",setswana:"tn",shona:"sn",sindhi:"sd",singhalese:"si",siswati:"ss",slovak:"sk",slovenian:"sl",somali:"so",spanish:"es",sudanese:"su",swahili:"sw",swedish:"sv",tagalog:"tl",tajik:"tg",tamil:"ta",tatar:"tt",tegulu:"te",thai:"th",tibetan:"bo",tigrinya:"ti",tonga:"to",tsonga:"ts",turkish:"tr",turkmen:"tk",twi:"tw",ukrainian:"uk",urdu:"ur",uzbek:"uz",vietnamese:"vi",volapuk:"vo",welsh:"cy",wolof:"wo",xhosa:"xh",yiddish:"ji",yoruba:"yo",zulu:"zu"},iso2lang:{ab:"Abkhazian",aa:"Afar",af:"Afrikaans",sq:"Albanian",am:"Amharic",ar:"Arabic",hy:"Armenian",as:"Assamese",ay:"Aymara",az:"Azerbaijani",ba:"Bashkir",eu:"Basque",bn:"Bengal",dz:"Bhutani",bh:"Bihari",bi:"Bislama",br:"Breton",bg:"Bulgarian",my:"Burmese",be:"Byelorussian",km:"Cambodian",ca:"Catalan",zh:"Chinese",co:"Corsican",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fiji",fi:"Finnish",fr:"French",fy:"Frisian",gd:"Gaelic",gl:"Galician",ka:"Georgian",de:"German",el:"Greek",kl:"Greenlandic",gn:"Guarani",gu:"Gujarati",ha:"Hausa",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic","in":"Indonesian",ia:"Interlingua",ie:"Interlingue",ik:"Inupiak",ga:"Irish",it:"Italian",ja:"Japanese",jw:"Javanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",rw:"Kinyarwanda",ky:"Kirghiz",rn:"Kirundi",ko:"Korean",ku:"Kurdish",lo:"Laothian",la:"Latin",lv:"Latvia",ln:"Lingala",lt:"Lithuanian",mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",mn:"Mongolian",na:"Nauru",ne:"Nepali",no:"Norwegian",oc:"Occitan",or:"Oriya",om:"Orom",ps:"Pasht",fa:"Persian",pl:"Polish",pt:"Portuguese",pa:"Punjabi",qu:"Quechua",rm:"Rhaeto-romance",ro:"Romanian",ru:"Russian",sm:"Samoan",sg:"Sangro",sa:"Sanskrit",sr:"Serbian",sh:"Serbo-croatian",st:"Sesotho",tn:"Setswana",sn:"Shona",sd:"Sindhi",si:"Singhalese",ss:"Siswati",sk:"Slovak",sl:"Slovenian",so:"Somali",es:"Spanish",su:"Sudanese",sw:"Swahili",sv:"Swedish",tl:"Tagalog",tg:"Tajik",ta:"Tamil",tt:"Tatar",te:"Tegulu",th:"Thai",bo:"Tibetan",ti:"Tigrinya",to:"Tonga",ts:"Tsonga",tr:"Turkish",tk:"Turkmen",tw:"Twi",uk:"Ukrainian",ur:"Urdu",uz:"Uzbek",vi:"Vietnamese",vo:"Volapuk",cy:"Welsh",wo:"Wolof",xh:"Xhosa",ji:"Yiddish",yo:"Yoruba",zu:"Zulu"}},videoelem="",torrentId="",torrentvar=null,filename="",refreshIntervalId="",hostApp={openBrowser:function(e){window.open(e)},onTorrent:function(e){function t(){var t=(100*e.progress).toFixed(1);100!=t?0==e.numPeers?app.torrent.updateInfo(t,window.client.downloadSpeed,e.numPeers,"Searching for peers"):app.torrent.updateInfo(t,window.client.downloadSpeed,e.numPeers,"Streaming"):app.torrent.updateInfo(t,window.client.downloadSpeed,e.numPeers,"Done")}torrentvar=e,refreshIntervalId=setInterval(t,1e3),t(),e.files.forEach(function(e){var t=e.name.substr((~-e.name.lastIndexOf(".")>>>0)+2),a=t.localeCompare("mp4");0===a&&e.appendTo("div.displays",function(e,t){if(e)throw e;videoelem=t})})},getTorrent:function(e){torrentId=e.torrent.magnet,ui.loading_wrapper.show();client.add(torrentId,hostApp.onTorrent)},cancelTorrent:function(){$(videoelem).remove(),clearInterval(refreshIntervalId),client.remove(torrentvar,function(e){})}},app={init:function(){try{app.state="mainWindow",app.config.init(),locale.construct(function(){ui.construct(),locale.translate_interface(),app.keyboardNav.init()}),app.setConfig()}catch(e){}},torrent:{current_torrent_id:"",get:function(e){hostApp.getTorrent(e)},cancel:function(){hostApp.cancelTorrent(app.torrent.current_torrent_id)},updateInfo:function(e,t,a,o){ui.loading_wrapper.change_stats(e,t,a,o)},hideLoading:function(){ui.loading_wrapper.hide()},error:function(e){ui.loading_wrapper.hide(),utils.msgbox(e)}}},logger={log:function(e){console.log(e)}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.substr(1)},window.onresize=function(){ui.events.window_resize()},window.onload=function(){setTimeout(app.init,1)},app.config={init:function(){this.fetcher={mode:"imdb",sortBy:"seeds"},this.api_keys={tmdb:"49101d62654e71a2931722642ac07e5e",tmdb_url:"http://api.themoviedb.org/3/",tmdb_src:"http://image.tmdb.org/t/p/"},this.locale={preferredSubs:localStorage.getItem("conf_locale_preferredSubs")};var e={ui:{coverScale:1.7,coverWidth:133,coverTiteSize:12,coverYearSize:12,coverToolsSize:12,coverStarsSize:17}};for(var t in e){this[t]={};for(var a in e[t])this[t][a]=localStorage.getItem("conf_"+t+"_"+a)||e[t][a]}},set:function(e){for(var t in e)for(var a in e[t])this[t][a]=e[t][a],localStorage.setItem("conf_"+t+"_"+a,e[t][a])},hostApp:{tempPath:localStorage.getItem("conf_hostApp_tempPath")||"",subsFontSize:localStorage.getItem("conf_hostApp_subsFontSize")||"0",cleanOnExit:localStorage.getItem("conf_hostApp_cleanOnExit")&&"0"!=localStorage.getItem("conf_hostApp_cleanOnExit"),hideGlare:localStorage.getItem("conf_hostApp_hideGlare")||!1},updateView:function(){$(".temp_path.txt").val(app.config.hostApp.tempPath),app.config.set({hostApp:{tempPath:app.config.hostApp.tempPath}})}},app.keyboardNav={init:function(){Mousetrap.bind("tab",function(){switch(app.state){case"mainWindow":$("#toolbar .btn").not(".activated").click()}}),Mousetrap.bind("right",function(){switch(app.state){case"mainWindow":if($("#movies_catalog .movie.khover").length){var e=$("#movies_catalog .movie.khover");$(".khover").removeClass("khover");var t=e.next();t.addClass("khover"),ui.home.catalog.scroller.scrollToElement(t[0],null,null,!0)}else $("#movies_catalog .movie").first().addClass("khover")}}),Mousetrap.bind("left",function(){switch(app.state){case"mainWindow":if($("#movies_catalog .movie.khover").length){var e=$("#movies_catalog .movie.khover");$(".khover").removeClass("khover");var t=e.prev();t.addClass("khover"),ui.home.catalog.scroller.scrollToElement(t[0],null,null,!0)}else $("#movies_catalog .movie").first().addClass("khover")}}),Mousetrap.bind("down",function(){switch(app.state){case"mainWindow":if($("body.sidemenu_open").length){var e=$("#genres_box .genre.khover");$(".khover").removeClass("khover");var t=e.length?e.next():$("#genres_box .genre").first();if(t.addClass("khover"),t.length){var a=t.position().top;(a<$("#genres_box")[0].scrollTop+15||a>$("#genres_box").height()-15)&&($("#genres_box")[0].scrollTop=a)}}else if($("#movies_catalog .movie.khover").length){var o=$("#movies_catalog .movie.khover"),i=o.index()+ui.home.catalog.numItemsInRow-1;if(i>0&&i<$("#movies_catalog .movie").length){$(".khover").removeClass("khover");var r=$("#movies_catalog .movie").eq(i);r.addClass("khover"),ui.home.catalog.scroller.scrollToElement(r[0],null,null,!0)}}else $("#movies_catalog .movie").first().addClass("khover")}}),Mousetrap.bind("up",function(){switch(app.state){case"mainWindow":if($("body.sidemenu_open").length){var e=$("#genres_box .genre.khover");$(".khover").removeClass("khover");var t=e.length?e.prev():$("#genres_box .genre").last();if(t.addClass("khover"),t.length){var a=t.position().top;(a<$("#genres_box")[0].scrollTop+15||a>$("#genres_box").height()-15)&&($("#genres_box")[0].scrollTop=a)}}else if($("#movies_catalog .movie.khover").length){var o=$("#movies_catalog .movie.khover"),i=o.index()-ui.home.catalog.numItemsInRow-1;if(i>0&&i<$("#movies_catalog .movie").length){$(".khover").removeClass("khover");var r=$("#movies_catalog .movie").eq(i);r.addClass("khover"),ui.home.catalog.scroller.scrollToElement(r[0],null,null,!0)}}else $("#movies_catalog .movie").first().addClass("khover")}}),Mousetrap.bind(["esc","backspace"],function(){switch(app.state){case"mainWindow":$("#search_cont.activated").length?($("#search_input").blur(),$("#search_cont.activated").removeClass("activated")):$("body.sidemenu_open").length?Mousetrap.trigger("shift"):$("#movies_catalog .movie.khover").removeClass("khover");break;default:$("body.loading #loading_wrapper .close").length?$("body.loading #loading_wrapper .close").click():$(".slider").length&&$(".slider").last().children(".close").click()}}),Mousetrap.bind("ctrl+-",function(){var e=parseInt($("#size_setter").val());$("#size_setter").val(-5+e).change()}),Mousetrap.bind(["ctrl++","ctrl+="],function(){var e=parseInt($("#size_setter").val());$("#size_setter").val(5+e).change()}),Mousetrap.bind("shift",function(){switch(app.state){case"mainWindow":$("body.sidemenu_open").length?($("body").removeClass("sidemenu_open"),$("#genres_box .genre.khover").removeClass("khover")):$("body").addClass("sidemenu_open")}}),Mousetrap.bind(["enter","space"],function(){switch(app.state){case"mainWindow":$("body.sidemenu_open").length?$("#genres_box .genre.khover").click():$("#movies_catalog .khover").click();break;case"movie":$("#slider_movie .watch-btn").click()}}),Mousetrap.bind(["f5"],function(){location.reload()}),Mousetrap.bind("v",function(){app.state}),Mousetrap.bind(["f","insert"],function(){switch(app.state){case"movie":$("#slider_movie .fav-btn").click();break;case"mainWindow":$("#movies_catalog .khover .fav-btn").click()}}),Mousetrap.bind("q",function(){switch(app.state){case"movie":var e=$("#slider_movie .quality_selector.activated").next(".enabled");e.length?e.click():$("#slider_movie .quality_selector.enabled").first().click()}}),Mousetrap.bind("t",function(){switch(app.state){case"movie":$("#slider_movie .trailer").is(":visible")&&$("#slider_movie .trailer").click()}}),Mousetrap.bind("b",function(){switch(app.state){case"mainWindow":$("#menu_panel .favs").click()}})}};var ui={construct:function(){this.home.catalog.set_sizes(),this.home.catalog.show(),$("#titlebar_buttons div").click(function(){hostApp.sendWinAction($(this).attr("id"))});for(var e=0;e<resource.genres.length;e++)$('<div class="genre" data-genre="'+resource.genres[e]+'" data-in-trans="'+resource.genres[e]+'">'+locale.translate(resource.genres[e])+"</div>").appendTo("#genres_box");$("#genres_box .genre:nth-child(1)").addClass("activated"),$("#toolbar_genres").hover(function(){setTimeout("ui.home.genres_box.on=1",1),ui.home.genres_box.show()},function(){ui.home.genres_box.on=0,ui.home.genres_box.hide()}),$("#genres_box .genre").click(function(){$("#genres_box .genre.activated").removeClass("activated"),$(this).addClass("activated"),$("#search_input").val(""),ui.home.catalog.show()}),$("#search_input").keydown(function(e){if(13==e.which&&$(this).val())$("#autocomplete .khover").length?$("#autocomplete .khover").click():ui.home.catalog.show();else if(40==e.which){var t=$("#autocomplete .khover");$("#autocomplete .khover").removeClass("khover");var a=t.length?t.next():$("#autocomplete div").first();a.addClass("khover")}else if(38==e.which){var t=$("#autocomplete .khover");$("#autocomplete .khover").removeClass("khover");var a=t.length?t.prev():$("#autocomplete div").last();a.addClass("khover")}}).focus(function(){$("#search_cont").addClass("activated")}).blur(function(){""==$(this).val()&&$("#search_cont").removeClass("activated"),setTimeout(function(){$("#autocomplete").removeClass("visible")},300)}).keyup(function(e){return 27==e.which?($("#search_input").blur(),void $("#search_cont.activated").removeClass("activated")):8!=e.which&&46!=e.which||""!=$(this).val()?void((e.which>40||8==e.which)&&$(this).val().length>2&&"movies"==$("#toolbar .btn.activated").data("section")&&(window.autocompleteXhr&&window.autocompleteXhr.abort&&window.autocompleteXhr.abort(),$("#autocomplete").html("").removeClass("visible"))):void ui.home.catalog.show()}),$("#search_cont .icon").click(function(){""!=$("#search_input").val()&&ui.home.catalog.show()}),$("#right_bar .icon.search").click(function(){ui.home.catalog.show()}),$("body").mousedown(function(e){ui.mouseDownClientX=e.clientX}),$("#mode_box span").click(function(){$("#mode_box span.activated").removeClass("activated"),$(this).addClass("activated"),app.config.fetcher.mode=$(this).html().toLowerCase()}),ui.loading_wrapper.init(),$("#mode_box span").click(function(){app.config.fetcher.mode=$(this).data("mode"),$("#mode_box .activated").removeClass("activated"),$(this).addClass("activated"),ui.home.catalog.show()})},home:{catalog:{items:{},set_sizes:function(e){e&&app.config.set({ui:{coverScale:e/100+1}});var t=$("body").width();ui.home.catalog.numItemsInRow=Math.floor(t/(app.config.ui.coverWidth*app.config.ui.coverScale)),ui.home.catalog.item_width=t/ui.home.catalog.numItemsInRow-1,ui.home.catalog.item_height=ui.home.catalog.item_width/.66,$("#movies_catalog .movie").css({width:ui.home.catalog.item_width+"px",height:ui.home.catalog.item_height+"px"}),$("#movies_catalog .movie .title").css("font-size",app.config.ui.coverTiteSize*app.config.ui.coverScale),$("#movies_catalog .movie .year").css("font-size",app.config.ui.coverYearSize*app.config.ui.coverScale),$("#movies_catalog .movie .tools").css("font-size",app.config.ui.coverToolsSize*app.config.ui.coverScale),$("#movies_catalog .movie .stars").css("font-size",app.config.ui.coverStarsSize*app.config.ui.coverScale),$("#size_setter").val(Math.round(100*(app.config.ui.coverScale-1))),ui.home.catalog.scroller&&ui.home.catalog.scroller.refresh()},show:function(e){e?ui.home.catalog.page=e:ui.home.catalog.page=1,ui.sliders.close_all(),app.state="mainWindow";var t=$("#search_input").data("imdb")||$("#search_input").val(),a=($(".genre.active"),t?"all":$("#genres_box .genre.activated").data("genre")||"all"),o=$("#toolbar .btn.activated").data("section");o||($("#header .activated").removeClass("activated"),$("#toolbar .btn:nth(0)").addClass("activated"),o="movies"),ui.home.catalog.section=o,fetcher.fetch.items(o,a,t,function(t,a){if(!t&&a instanceof Array){e||(ui.home.catalog.clear(),$('<div style="width:100%;height:65px;float:left"></div>').appendTo("#catalog_scroller"));for(var i=0;i<a.length;i++)ui.home.catalog.appendItem(a[i],o,i);$("#movies_catalog").bind("scroll",function(){$(this).scrollTop()+$(this).innerHeight()>=this.scrollHeight-400&&ui.home.catalog.show(++ui.home.catalog.page)}),ui.home.catalog.showUnloadedItems(ui.home.catalog.page),ui.home.catalog.scroller?ui.home.catalog.scroller.refresh():(ui.home.catalog.scroller=new IScroll("#movies_catalog",{mouseWheel:!0,mouseWheelSpeed:30,scrollbars:!0,hScrollbar:!1,vScrollbar:!0,click:!0,fadeScrollbars:!0,interactiveScrollbars:!0,resizeScrollbars:!0,shrinkScrollbars:"scale"}),ui.home.catalog.scroller.on("scrollEnd",function(){"favs"!=ui.home.catalog.section&&Math.abs(this.maxScrollY)-Math.abs(this.y)<600&&ui.home.catalog.page&&ui.home.catalog.show(++ui.home.catalog.page)})),e||ui.home.catalog.scroller.scrollTo(0,0)}else ui.home.catalog.noResult(),logger.log(t)})},appendItem:function(e,t,a){var o={id:e.imdb,title:e.title,year:e.year,runtime:e.runtime,stars:e.stars,poster_img:'<img src="'+e.poster_small+'" onload="setTimeout(function(){$(\'#movie-'+e.imdb+"').css({opacity: 1,transform: 'scale(1, 1)'})},1);$('#movie-"+e.imdb+"').removeClass('unloaded')\">",titleFontSize:app.config.ui.coverTiteSize*app.config.ui.coverScale,yearFontSize:app.config.ui.coverYearSize*app.config.ui.coverScale,toolsFontSize:app.config.ui.coverToolsSize*app.config.ui.coverScale,starsFontSize:app.config.ui.coverStarsSize*app.config.ui.coverScale},i=utils.tokenizer(o,document.getElementById("movie_cover_html").innerHTML);ui.home.catalog.items[e.imdb.toString()]||(ui.home.catalog.items[e.imdb.toString()]=e),$('<div data-section="'+t+'" data-movie_id="'+e.imdb.toString()+'"  id="movie-'+e.imdb.toString()+'" style="width:'+ui.home.catalog.item_width+"px;height:"+ui.home.catalog.item_height+"px;transition-delay: 0s, "+a/23+'s;" class="movie unloaded p'+ui.home.catalog.page+'">'+i+"</div>").appendTo("#catalog_scroller").click(function(e){-1==$(e.target).attr("class").indexOf("-btn")&&ui[$(this).data("section")].show($(this).data("movie_id"))}).mouseenter(function(){$("#movies_catalog .movie.khover").removeClass("khover"),$(this).addClass("khover")})},showUnloadedItems:function(e){setTimeout(function(){$("#movies_catalog .unloaded.p"+e).css({opacity:1,transform:"scale(1, 1)"}).removeClass("unloaded")},5e3)},clear:function(){$("#catalog_scroller").html("")},noResult:function(){1==ui.home.catalog.page&&$("#catalog_scroller").html('<div class="noResults">No results found...</div>');try{ui.home.catalog.scroller.scrollToElement($("#catalog_scroller .noResults")[0],null,null,!0)}catch(e){}fetcher.scrappers.movies_idx=0}}},sliders:{slider:{},close_all:function(){for(var e in ui.sliders.slider)ui.sliders.slider[e].hide()}},slider:function(e,t){if(ui.sliders[e])return ui.sliders[e];var a=function(){var e={fadein:[{top:"0"},{top:"0"}],bottom:[{top:"0"},{top:"200%"}],right:[{left:"0"},{left:"200%"}],left:[{left:"0"},{left:"-200%"}]};return t&&e[t]?[e[t],t]:[e.fadein,"fadein"]}(),o=$('<div id="slider_'+e+'" class="slider '+a[1]+'" data-id="'+e+'"><div class="close" onclick="ui.sliders.slider[\''+e+"'].hide()\"></div></div>");return o.appendTo("body"),ui.sliders.slider[e]={el:o,id:e,show:function(){var e=a[0][0];e.opacity=1,setTimeout(function(){o.css(e)},1)},hide:function(){var t=a[0][1];t.opacity=0,o.fadeOut(function(){$(this).remove()}),"function"==typeof this.destruct&&this.destruct(),delete ui.sliders.slider[e]}},ui.sliders.slider[e]},torrent_report:{show:function(e){$(e).parents(".torrent_info").fadeOut("fast",function(){var e=$(this).next(".torrent_report");e.fadeIn("fast"),setTimeout(function(){ui.torrent_report.hide(e)},5e3)})},hide:function(e){e.length&&e.fadeOut("fast",function(){$(this).prev(".torrent_info").fadeIn("fast")})},send:function(e,t){var a=$(e).parents(".torrent_option");a.data("id");a.fadeOut("fast",function(){utils.msgbox('<span style="font-size:16px;">Hasta la vista, Torrent</span>'),$(this).remove(),$(".slider .torrents .torrent_option:first-child").addClass("activated")})}},trailer:{show:function(e){var t=new ui.slider("trailer","fadein");t.el.append('<div style="width:100%;height:calc(100% - 35px);margin-top:35px;box-sizing:border-box;overflow:hidden;"><iframe src="'+e+'" style="width:100%;height:100%;" frameborder="0" scrolling="0"></iframe></div>'),t.show()},close:function(){ui.sliders.slider.trailer.hide()}},events:{watch_btn_click:function(e){ui.loading_wrapper.show();var t=document.section.chosen[0].checked?"movie_slider":"tvshow_slider",a="0"!=$("#"+t+" .torrents_list").val().toString()?$("#"+t+" .torrents_list").val().split(","):$("#"+t+" .torrents_list option")[1].value.split(","),o="0"!=$("#"+t+" .subtitles_list").val().toString()?$("#"+t+" .subtitles_list").val():null;app.torrent.get(a[0],a[1],o)},window_resize:function(){ui.home.catalog.set_sizes()}},disableAnimations:function(e){$("body")[e?"addClass":"removeClass"]("disable_animations")},hideGlare:function(e){console.log(e.value),app.config.set({hostApp:{hideGlare:e.checked?1:0}}),$("body")[e.checked?"addClass":"removeClass"]("hideGlare")}};ui.movies={session:{},show:function(e){var t=ui.home.catalog.items[e];if(!t)return void logger.log("error_missing_movie_catalog_id_"+e);var a=this.slider(t),o=this.handlers[app.config.fetcher.mode];ui.movies.session={id:t.id,imdb:t.id,title:t.title,info:t.year,year:t.year,image:t.poster_big,section:"movies"},this.set_torrents(t),this.construct(t);for(var i in o)o[i](t);a.show(),setTimeout(function(){app.state="movie"},100)},slider:function(e){if(!$(".slider_"+e.id).length){ui.sliders.close_all();var t=utils.tokenizer(e,$("#movie_slider_html").html());return slider=new ui.slider("movie","fadein"),slider.destruct=function(){app.state="mainWindow"},slider.el.append(t).addClass("movie_"+e.id),slider}},watch:function(e){if(window.deviceNotSupport)return void $("#deviceNotSupported").show();Mousetrap.pause(),app.torrent.get(this.session);var t=ui.movies.session;t.torrents=ui.home.catalog.items[this.session.id].torrents},set_torrents:function(e){var t=$("#slider_movie.movie_"+e.imdb+" .torrent_selector .selector_cont");if(t.html(""),e.torrents instanceof Array&&e.torrents.length){$("#slider_movie.movie_"+e.imdb+" .watch-btn").show(),e.torrents.forEach(function(e,a){0==a&&(ui.movies.session.torrent={url:e.torrent_url,magnet:e.torrent_magnet,file:e.file,quality:e.quality}),$('<div class="item torrent '+(0==a?"activated":"")+" "+e.quality.toLowerCase()+'" data-idx="'+a+'" data-quality="'+e.quality.toLowerCase()+'"><div class="icon2 baterry '+utils.calculateTorrentHealth(e.torrent_seeds,e.torrent_peers)+'"></div><div class="caption">'+e.torrent_seeds+"/"+e.torrent_peers+" Peers</div></div>").appendTo(t).click(function(){$(".item.torrent.activated").removeClass("activated"),$(this).addClass("activated");var e=ui.home.catalog.items[ui.movies.session.id].torrents[parseInt($(this).data("idx"))];ui.movies.session.torrent={url:e.torrent_url,magnet:e.torrent_magnet,file:e.file,quality:e.quality}})}),$("#slider_movie .quality_selector").click(function(){$(this).hasClass("enabled")&&($("#slider_movie .quality_selector.activated").removeClass("activated"),$(this).addClass("activated"),$("#slider_movie .torrent").removeClass("activated").hide(),$("#slider_movie .torrent."+$(this).data("quality")).show().first().click())});var a=$("#slider_movie .torrent").first(),o=a.data("quality");$("#slider_movie .quality_selector").each(function(){$("#slider_movie .torrent."+$(this).data("quality")).length&&$(this).addClass("enabled")}),$("#slider_movie .quality_selector."+o).click()}else t.html('<div class="item"><div class="caption">No torrents</div></div>'),$("#slider_movie.movie_"+e.imdb+" .watch-btn").hide()},construct:function(e){e.trailer&&$("#slider_movie.movie_"+e.id+" .trailer").show().click(function(){ui.trailer.show(e.trailer)})},getTrailer:function(e){ui.movies.infoXHR=$.get("//api.themoviedb.org/3/movie/"+e.tmdb_id+"/videos?api_key="+app.config.api_keys.tmdb,function(t){if(t&&t.results.length){var a=t.results[0].key?"//www.youtube.com/embed/"+t.results[0].key+"?autoplay=1":!1;a&&$("#slider_movie.movie_"+e.id+" .trailer").show().click(function(){ui.trailer.show(a)}),e.trailer=a}},"json")},handlers:{imdb:{get_movie_info:function(e){ui.movies.infoXHR&&"function"==typeof ui.movies.infoXHR.abort&&ui.movies.infoXHR.abort();var t=function(){$(".slider.movie_"+e.imdb+" .synopsis").html(e.synopsis).addClass("fadein"),$(".slider.movie_"+e.imdb+" .title_info .runtime").html(e.runtime),$(".slider.movie_"+e.imdb+" .title_info.genre").html(e.genre),$(".slider.movie_"+e.imdb+" .title_info.stars").attr("title",e.voteAverage+" / 10").click(function(){hostApp.openBrowser("http://www.imdb.com/title/"+e.imdb)}).children("span").css({cursor:"pointer"})};e.synopsis&&e.runtime&&e.genre?setTimeout(t,100):ui.movies.infoXHR=$.get("//api.themoviedb.org/3/movie/"+e.imdb+"?api_key="+app.config.api_keys.tmdb,function(a){a&&(e.tmdb_id=a.id,e.synopsis=a.overview,e.runtime=a.runtime+" "+locale.translate("durationUnit"),e.genre=a.genres instanceof Array?a.genres[0]&&a.genres[0].name||"":"",e.trailer||ui.movies.getTrailer(e)),t()},"json")},load_images:function(e){ui.movies.imgsXHR&&"function"==typeof ui.movies.imgsXHR.abort&&ui.movies.imgsXHR.abort(),ui.movies.imgsXHR=$.get(app.config.api_keys.tmdb_url+"movie/"+e.imdb+"/images?api_key="+app.config.api_keys.tmdb,function(t){var a=e.poster_big;if("object"==typeof t){if(t.posters)for(var o=!1,i=0;i<t.posters.length;i++)if(t.posters[i].height>1080){if(t.posters[i].iso_639_1==locale.language){a=app.config.api_keys.tmdb_src+"w780/"+t.posters[i].file_path;break}o||"en"!=t.posters[i].iso_639_1||(a=app.config.api_keys.tmdb_src+"w780/"+t.posters[i].file_path,o=!0)}t.videos&&console.log(t.videos);var r=new Image;r.onload=function(){clearTimeout(n),$("#slider_movie.movie_"+e.id+" .poster_img").attr("src",a).addClass("fadein"),setTimeout(s,2222)},r.src=a;var n=setTimeout(function(){s()},5e3),s=function(){if(t.backdrops instanceof Array){var a=function(o){if($(".movie_"+e.id).length&&(!(o>=t.backdrops.length)||(o=0,$("#slider_movie.movie_"+e.id+" .backdrop_img").length))){var i=t.backdrops[o];
if(1920==i.width){var r=app.config.api_keys.tmdb_src+"w"+i.width+i.file_path,n=new Image;n.onload=function(){ui.movies.session.image=r.replace("w"+i.width,"w185"),$('<div class="backdrop_img"><div class="img" style="background-image:url('+r+')">').appendTo("#slider_movie .backdrop"),$("#slider_movie .backdrop_img.fadein").fadeOut("slow",function(){$(this).remove()}),setTimeout(function(){$("#slider_movie .backdrop_img").last().addClass("fadein"),setTimeout(function(){a(++o)},6750)},10)},n.src=r}else setTimeout(function(){a(++o)},500)}};a(0)}}}},"json")}}}},ui.settings_page={show:function(){if(ui.sliders.slider.settings)return void ui.sliders.slider.settings.hide();var e=(app.config.hostApp.tempPath,""),t="",a={2:"Extra large",1:"Large",0:"Normal","-1":"Small","-2":"Extra small"},o=(app.config.hostApp.subsFontSize||"0").toString();for(var i in locale.langs)e+='<option value="'+i+'" '+(locale.language==i?"selected":"")+">"+locale.langs[i]+"</option>";for(var i in a)t+='<option value="'+i+'" '+(o==i?"selected":"")+">"+a[i]+"</option>";1==app.config.hostApp.hideGlare?($("body").addClass("hideGlare"),$(".hideGlare_input").attr("checked",1)):$(".hideGlare_input").removeAttr("checked");var r=new ui.slider("settings","left"),n={languages:e,cache_path:app.config.hostApp.tempPath,fontSizes:t},s=utils.tokenizer(n,$("#settings_page_html").html());r.el.append(s),app.config.hostApp.cleanOnExit&&($("#slider_settings input.cf_checkbox")[0].checked=!0),$("#slider_settings select.langs").change(function(){var e=$(this).val();locale.langs[e];localStorage.setItem("locale",e),localStorage.removeItem("locale_words"),locale.construct(function(){locale.translate_interface()})}),r.show()}},ui.loading_wrapper={init:function(){},show:function(e){$("#loading_wrapper").addClass("activated"),$("body").addClass("loading"),$("#loading_wrapper .f")[e?"hide":"show"](),ui.loading_wrapper.change_stats(0,0,0,"Searching for peers")},hide:function(e){$("#loading_wrapper").removeClass("activated"),$("body").removeClass("loading"),$("#loading_wrapper .bar").removeClass("on"),this.percent=0,ui.loading_wrapper.change_stats(0,0,0,"Searching for peers"),app.torrent.cancel(),Mousetrap.unpause()},change_stats:function(e,t,a,o){e=Math.round(e);var i=Math.ceil(e/2);i&&($("#loading_wrapper .bar").removeClass("on"),$("#loading_wrapper .bar").slice(0,i).addClass("on")),t=(t/1024).toFixed(2),t>1024?t=(t/1024).toFixed(2)+" Mb/s":t+=" Kb/s",$("#loading_wrapper .peers .val").html(a),$("#loading_wrapper .speed .val").html(t),$("#loading_wrapper .msg").html(locale.translate(o))}};var fetcher={scrappers:{imdb:{movies_idx:0,movies:["free_movies","free_movies"]}},fetch:{items:function(e,t,a,o){var i=app.config.fetcher.mode,r=fetcher.scrappers[i][e+"_idx"],n=fetcher.scrappers[i][e][r];if("string"==typeof n){var s=fetcher.scrappers[n];"function"==typeof s?s(t,a,null,function(r){r?(fetcher.scrappers[i][e+"_idx"]=0,o(!1,r)):(fetcher.scrappers[i][e+"_idx"]++,fetcher.fetch.items(e,t,a,o))}):(logger.log("error_no_scrapper_function_"+n),fetcher.scrappers[i][e+"_idx"]++,fetcher.fetch.items(e,t,a,o))}else fetcher.scrappers[i][e+"_idx"]=0,o("end_of_scrappers_movies")}}},utils={load_script:function(e,t){var a,o=document.createElement("script");o.setAttribute("src",e),t&&(o.onreadystatechange=o.onload=function(){a||t(),a=!0}),document.getElementsByTagName("head")[0].appendChild(o)},tokenizer:function(e,t){return t.replace(/\[##([^#]+)##\]/g,function(){var t={toolbox_html:$("#watch_toolbox").html()};return e[arguments[1]]||t[arguments[1]]||""})},movie:{rateToStars:function(e){if(!e)return['<span class="icon star_empty"></span>','<span class="icon star_empty"></span>','<span class="icon star_empty"></span>','<span class="icon star_empty"></span>','<span class="icon star_empty"></span>'].join("");for(var t=Math.round(e.toFixed(1))/2,a="",o=1;o<=Math.floor(t);o++)a+='<span class="icon star"></span>';t%1>0&&(a+='<span class="icon star_half"></span>');for(var o=Math.ceil(t);5>o;o++)a+='<span class="icon star_empty"></span>';return a}},msgbox:function(e){$("#msg div").html(e),$("#msg").show(),setTimeout(function(){$("#msg").hide()},5500)},url_response:{},url_request:function(e,t){utils.url_response[e]=t;try{hostApp.url_request(e)}catch(a){}},calculateTorrentHealth:function(e,t){var a=t-e,o=a>0?e/a:e;return 100>e?"bad":e>=100&&200>e?o>5?"good":o>3?"medium":"bad":e>=200?o>5?"excellent":o>3?"good":o>2?"medium":"bad":void 0},popupwindow:function(e,t,a,o){var i=screen.width/2-a/2,r=screen.height/2-o/2;return window.open(e,t,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+a+", height="+o+", top="+r+", left="+i)}},resource={genres:["all","action","adventure","animation","biography","comedy","crime","documentary","drama","family","fantasy","film-noir","history","horror","music","musical","mystery","romance","sci-fi","short","sport","thriller","war","western"],lang2code:{af:"za",sq:"al",ar:"sa",hy:"am",cy:"az",lt:"az",eu:"es",be:"by",bg:"bg",bs:"bs",ca:"es",zh:"cn",hr:"hr",cs:"cz",da:"dk",nl:"nl",en:"us",et:"ee",fo:"fo",fa:"ir",fi:"fi",fr:"fr",gl:"es",de:"de",el:"gr",gu:"in",he:"il",hi:"in",hu:"hu",is:"is",id:"id",it:"it",ja:"jp",kn:"in",kk:"kz",kok:"in",ko:"kr",ky:"kz",lv:"lv",lt:"lt",mk:"mk",ms:"my",mr:"in",mn:"mn",nb:"no",nn:"no",no:"no",pl:"pl",pt:"br",pt:"pt",pa:"in",ro:"ro",ru:"ru",sa:"in",cy:"sr",lt:"sr",sk:"sk",sl:"si",es:"es",sw:"ke",sv:"se",sr:"sr",syr:"sy",ta:"in",tt:"ru",te:"in",th:"th",tr:"tr",uk:"ua",ur:"pk",cy:"uz",lt:"uz",vi:"vn"}};fetcher.scrappers.free_movies=function(e,t,a,o,i){"all"==e&&(e=!1);var r=window.location.href+"API/API";i&&(r=window.location.href+"API/API");var n=r+"?sort="+app.config.fetcher.sortBy+"&cb="+Math.random()+"&quality=720p,1080p,3d&page="+ui.home.catalog.page;t&&(n+="&keywords="+t),e&&(n+="&genre="+e),a&&a.toString().match(/\d+/)&&(n+="&set="+a),n="https://json2jsonp.com/?url="+encodeURIComponent(n),$.ajax({url:n,dataType:"jsonp",jsonpCallback:"cbfunc",contentType:"application/json",timeout:9e3,error:function(){i?o(!1):fetcher.scrappers.free_movies(e,t,a,o,!0)},success:function(r){var n=[],s={};return e&&delete r.downloads,r.error||"undefined"==typeof r.downloads?void(i?o(!1):fetcher.scrappers.free_movies(e,t,a,o,!0)):(r.downloads.forEach(function(e){try{var t={id:e.ImdbCode,imdb:e.ImdbCode,title:e.MovieTitleClean,year:e.MovieYear?e.MovieYear:"&nbsp;",runtime:e.Runtime,synopsis:e.Synopsis,voteAverage:parseFloat(e.MovieRating),poster_small:e.CoverImage,poster_big:e.CoverImage,quality:e.Quality,torrent:e.TorrentUrl,magnet:e.TorrentUrl,torrents:[{file:e.MovieTitleClean,id:"",language:"",quality:e.Quality,size_bytes:e.SizeByte,subtitles:"",torrent_magnet:e.TorrentUrl,torrent_peers:e.TorrentPeers,torrent_seeds:e.TorrentSeeds,torrent_url:e.TorrentUrl,type:0}],videos:{},seeders:e.TorrentSeeds,leechers:e.TorrentPeers,trailer:e.trailer?"http://www.youtube.com/embed/"+e.trailer+"?autoplay=1":!1,stars:utils.movie.rateToStars(parseFloat(e.MovieRating)),hasMetadata:!1,hasSubtitle:!1},a=s[e.ImdbCode];"undefined"==typeof a&&(a=s[e.ImdbCode]=t),a.quality!==t.quality&&"720p"===t.quality&&(a.torrent=t.torrent,a.quality="720p"),a.torrents[e.Quality]=e.TorrentUrl,-1!==n.indexOf(a)||ui.home.catalog.items[e.ImdbCode]||n.push(a)}catch(o){}}),void(t&&!n.length?console.log(n.length):o(n)))}})};